---
title: "Lesson 8: Probability density functions (PDFs)"
author: "Meike Niederhausen and Nicky Wakim"
date: " `r library(here); source(here('class_dates.R')); w4d1` "
title-slide-attributes:
    data-background-color: "#006a4e"
format: 
  revealjs:
    theme: "../simple_NW.scss"
    slide-number: true
    show-slide-number: all
    width: 1955
    height: 1100
    footer: Lesson 8 Slides
    html-math-method: mathjax
---

```{r setup, include=FALSE}
library(here)
library(tidyverse)
source(here("class_dates.R"))

theme_set(theme_minimal(base_size = 28))
theme_update(plot.title = element_text(size = 28, hjust = 0.5))
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = TRUE)
```

# Learning Objectives

1.  Distinguish between discrete and continuous random variables.

2.  Calculate probabilities for continuous random variables.

3.  Use R to simulate known continuous distributions.

## Where are we?

![](../img_slides/course_map.png){fig-align="center"}

# Learning Objectives

::: lob
1.  Distinguish between discrete and continuous random variables.
:::

2.  Calculate probabilities for continuous random variables.

3.  Use R to simulate known continuous distributions.

## Discrete vs. Continuous RVs

::: columns
::: {.column width="60%"}
-   For a **discrete** RV, the set of possible values is either finite
    or can be put into a countably infinite list.

    Â 

-   **Continuous** RVs take on values from continuous *intervals*, or
    unions of continuous intervals
:::

::: {.column width="39%"}
![Figure from Introduction to Probability TB (pg.
301)](../img_slides/Cont_RV_Disc_RV.png){fig-align="center"}
:::
:::

## How to define probabilities for continuous RVs?

::: columns
::: column
Discrete RV $X$:

```{r}
#| fig-height: 6
#| fig-width: 7
#| fig-align: center
#| echo: false

library(ggplot2)
data = data.frame(x = seq(0, 10, 1), y = seq(0, 0.5, 0.05))
ggplot(data, aes(x = x, y = y)) +
  labs(x = "x", y = "Probability") +
  theme_minimal() +
  theme(text = element_text(size=28))
```

- pmf: $p_X(x) = P(X=x)$
:::
::: column
Continuous RV $X$:

```{r}
#| fig-height: 6
#| fig-width: 7
#| fig-align: center
#| echo: false

library(ggplot2)
data = data.frame(x = seq(0, 10, 1), y = seq(0, 1, 0.1))
ggplot(data, aes(x = x, y = y)) +
  labs(x = "x", y = "Density") +
  theme_minimal() +
  theme(text = element_text(size=28))
```

- density: $f_X(x)$
- probability: $P(a \leq X \leq b) = \int_a^b f_X(x)dx$
:::
:::

## What is a probability density function?

::: definition
::: def-title
Probability density function
:::

::: def-cont
The probability distribution, or **probability density function (pdf)**,
of a continuous random variable $X$ is a function $f_X(x)$, such that
for all real values $a,b$ with $a \leq b$,

$$\mathbb{P}(a \leq X \leq b) = \int_a^b f_X(x)dx$$
:::
:::

**Remarks:**

1.  Note that $f_X(x) \neq \mathbb{P}(X=x)$!!!

2.  In order for $f_X(x)$ to be a pdf, it needs to satisfy the
    properties

    -   $f_X(x) \geq 0$ for all $x$

    -   $\int_{-\infty}^{\infty} f_X(x)dx=1$

# Learning Objectives

1.  Distinguish between discrete and continuous random variables.

::: lob
2.  Calculate probabilities for continuous random variables.
:::

3.  Use R to simulate known continuous distributions.

## Let's demonstrate the PDF with an example (1/5)

::: columns
::: {.column width="30%"}
::: example
::: ex-title
Example 1.1
:::

::: ex-cont
Let $f_X(x)= 2$, for $a \leq x \leq 3$.

1.  Find the value of $a$ so that $f_X(x)$ is a pdf.
:::
:::
:::
:::

## Let's demonstrate the PDF with an example (2/5)

::: columns
::: {.column width="30%"}
::: example
::: ex-title
Example 1.2
:::

::: ex-cont
Let $f_X(x)= 2$, for $a \leq x \leq 3$.

2.  Find $\mathbb{P}(2.7 \leq X \leq 2.9)$.
:::
:::
:::
:::

## Let's demonstrate the PDF with an example (3/5)

::: columns
::: {.column width="30%"}
::: example
::: ex-title
Example 1.3
:::

::: ex-cont
Let $f_X(x)= 2$, for $a \leq x \leq 3$.

3.  Find $\mathbb{P}(2.7 < X \leq 2.9)$.
:::
:::
:::
:::

## Let's demonstrate the PDF with an example (4/5)

::: columns
::: {.column width="30%"}
::: example
::: ex-title
Example 1.4
:::

::: ex-cont
Let $f_X(x)= 2$, for $a \leq x \leq 3$.

4.  Find $\mathbb{P}(X = 2.9)$.
:::
:::
:::
:::

## Let's demonstrate the PDF with an example (5/5)

::: columns
::: {.column width="30%"}
::: example
::: ex-title
Example 1.5
:::

::: ex-cont
Let $f_X(x)= 2$, for $a \leq x \leq 3$.

5.  Find $\mathbb{P}(X \leq 2.8)$.
:::
:::
:::
:::

# Learning Objectives

1.  Distinguish between discrete and continuous random variables.

2.  Calculate probabilities for continuous random variables.

::: lob
3.  Use R to simulate known continuous distributions.
:::

## Use R to simulate known distributions

- We can use R to simulate continuous random variables and visualize their distributions
- For example, we can simulate a *uniform* distribution between 2.5 and 3

```{r}
#| echo: true
#| output-location: column
#| fig-align: center
#| fig-height: 6
#| fig-width: 9

uniform = tibble(
  x = runif(n=10000, min=2.5, max=3)
)

ggplot(uniform, 
       aes(x = x, 
           y = after_stat(density))) +
  geom_histogram( binwidth = 0.001) + 
  geom_abline(intercept = 2, slope = 0) + 
  labs(
    title = "Probability density function (pdf) of X",
    x = "x",
    y = "pdf"
  ) 
```

## Use R to simulate any continuous distribution

- We will discuss other ways to simulate continuous distributions once we cover cumulative distribution functions (CDFs) and inverse CDFs
