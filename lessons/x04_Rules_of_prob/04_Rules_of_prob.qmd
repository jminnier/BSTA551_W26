---
title: "Lesson 4: Rules of probability"
author: "Meike Niederhausen and Nicky Wakim"
title-slide-attributes:
    data-background-color: "#006a4e"
date: " `r library(here); source(here('class_dates.R')); w2d2` "
format: 
  revealjs:
    theme: "../simple_NW.scss"
    slide-number: true
    show-slide-number: all
    width: 1955
    height: 1100
    footer: Lesson 4 Slides
    html-math-method: mathjax
---

```{r setup, include=FALSE}
library(here)
source(here("class_dates.R"))
```

# Learning objectives

1.  Define independence of 2-3 events and decide whether two or more events are independent

2.  Define key facts for conditional probabilities and calculate conditional probabilities.

3.  Calculate the probability of an event using Bayes' Theorem, Higher Order Multiplication Rule, and the Law of Total Probabilities

## Where are we?

![](../img_slides/course_map.png){fig-align="center"}

## General Process for Probability Word Problems

1.  Clearly define your events of interest

2.  Translate question to probability using defined events OR Venn Diagram

3.  Ask yourself:

    -   Are we sampling with or without replacement?

    -   Does order matter?

4.  Use axioms, properties, partitions, facts, etc. to define the end probability calculation into smaller parts

    -   If probabilities are given to you, Venn Diagrams may help you parse out the events and probability calculations

    -   If you need to find probabilities with counting, pictures or diagrams might help here

5.  Write out a concluding statement that gives the probability context

6.  (For own check) Make sure the calculated probability follows the axioms. Is is between 0 and 1?

# Learning objectives

::: lob
1.  Define independence of 2-3 events and decide whether two or more events are independent
:::

2.  Define key facts for conditional probabilities and calculate conditional probabilities.

3.  Calculate the probability of an event using Bayes' Theorem, Higher Order Multiplication Rule, and the Law of Total Probabilities

## Independent Events

::::: definition
::: def-title
Definition: Independence
:::

::: def-cont
Events $A$ and $B$ are **independent** if $$\mathbb{P}(A \cap B) = \mathbb{P}(A) \cdot  \mathbb{P}(B).$$
:::
:::::

**Notation:** For shorthand, we sometimes write $A \mathrel{\unicode{x2AEB}} B,$ to denote that $A$ and $B$ are independent events.

Â 

-   Also note: $$\begin{aligned} \mathbb{P}(A \cap B) = \mathbb{P}(A) \cdot  \mathbb{P}(B) & \implies A \mathrel{\unicode{x2AEB}} B \\
    A \mathrel{\unicode{x2AEB}} B & \implies \mathbb{P}(A \cap B) = \mathbb{P}(A) \cdot  \mathbb{P}(B) \end{aligned}$$

## Example of two dice

::::: example
::: ex-title
Example 1
:::

::: ex-cont
Two dice (green and blue) are rolled. Let $A =$ event a total of 7 appears, and $B =$ event green die is a six. Are events $A$ and $B$ independent?
:::
:::::

![](/lessons/img_slides/indep_2dice.png)

## Example of two dice: simulating in R (1/2)

::::: example
::: ex-title
Example 1
:::

::: ex-cont
Two dice (green and blue) are rolled. Let $A =$ event a total of 7 appears, and $B =$ event green die is a six. Are events $A$ and $B$ independent?
:::
:::::

```{r}
#| echo: true

set.seed(1002)
reps = 10000
rolls = replicate(reps, sample(x = 1:6, size = 2, replace = TRUE))
rolls[, 1:10]

event_A = ( rolls[1, ] + rolls[2, ] == 7 )
head(event_A, 10)


event_B = ( rolls[1, ] == 6 )
head(event_B, 10)
```

## Example of two dice: simulating in R (1/2)

::::: example
::: ex-title
Example 1
:::

::: ex-cont
Two dice (green and blue) are rolled. Let $A =$ event a total of 7 appears, and $B =$ event green die is a six. Are events $A$ and $B$ independent?
:::
:::::

```{r}
#| echo: true

( sum(event_A) / reps ) * ( sum(event_B) / reps )

event_A_and_B = ( rolls[1, ] + rolls[2, ] == 7 ) & ( rolls[1, ] == 6 )
head(event_A_and_B, 10)
sum(event_A_and_B) / reps
```

## Independence of 3 Events

::::: definition
::: def-title
Definition: Independence of 3 Events
:::

::: def-cont
*Events* $A$, $B$, and $C$ are *mutually* **independent** if

1.  

    -   $\mathbb{P}(A \cap B) = \mathbb{P}(A) \cdot \mathbb{P}(B)$

    -   $\mathbb{P}(A \cap C) = \mathbb{P}(A) \cdot \mathbb{P}(C)$

    -   $\mathbb{P}(B \cap C) = \mathbb{P}(B) \cdot \mathbb{P}(C)$

2.  $\mathbb{P}(A \cap B \cap C) = \mathbb{P}(A) \cdot \mathbb{P}(B) \cdot \mathbb{P}(C)$
:::
:::::

**Remark:**

On your homework you will show that $(1) \not \Rightarrow (2)$ and $(2) \not \Rightarrow (1)$.

## Probability at least one smoker

::::::: columns
:::::: {.column width="34%"}
::::: example
::: ex-title
Example 2
:::

::: ex-cont
Suppose you take a random sample of $n$ people, of which people are smokers and non-smokers independently of each other. Let

-   $A_i =$ event person $i$ is a smoker, for $i=1, \ldots ,n$, and

-   $p_i =$ probability person $i$ is a smoker, for $i=1, \ldots ,n$.

Find the probability that at least one person in the random sample is a smoker.
:::
:::::
::::::
:::::::

## Building geometric series {visibility="hidden"}

::::: example
::: ex-title
Example 3
:::

::: ex-cont
$A, B,$ and $C$ toss a fair coin in order. The first to throw heads wins. What are their respective chances of winning?
:::
:::::

Let

-   $A_H$ and $A_T$ be the events player A tosses heads and tails, respectively.

-   Similarly define $B_H$, $B_T$, $C_H$, and $C_T$.

# Learning objectives

1.  Define independence of 2-3 events and decide whether two or more events are independent

::: lob
2.  Define key facts for conditional probabilities and calculate conditional probabilities.
:::

3.  Calculate the probability of an event using Bayes' Theorem, Higher Order Multiplication Rule, and the Law of Total Probabilities

## Let's revisit our deck of cards {visibility="hidden"}

:::::::: columns
:::::: {.column width="35%"}
::::: example
::: ex-title
Example 1
:::

::: ex-cont
Suppose we randomly draw 2 cards from a standard deck of cards. What is the probability that we draw a spade then a heart?
:::
:::::

Let

-   Let $A =$ event $1^{st}$ card is spades

-   Let $B =$ event $2^{nd}$ card is heart
::::::

::: column
:::
::::::::

## Conditional Probability facts (1/2)

::::::::::: columns
:::::: column
::::: fact
::: fact-title
Fact 1: General Multiplication Rule
:::

::: fact-cont
$$\mathbb{P}(A\cap B)=\mathbb{P}(A)\cdot\mathbb{P}(B|A)$$
:::
:::::
::::::

:::::: column
::::: fact
::: fact-title
Fact 2: Conditional Probability Definition
:::

::: fact-cont
$$\mathbb{P}(A|B)=\frac{\mathbb{P}(A\cap B)}{\mathbb{P}(B)}$$
:::
:::::
::::::
:::::::::::

## Conditional Probability facts (2/2)

::::::::::: columns
:::::: column
::::: fact
::: fact-title
Fact 3
:::

::: fact-cont
If $A$ and $B$ are independent events ($A \unicode{x2AEB}B$), then $$\mathbb{P}(A|B) = \mathbb{P}(A)$$
:::
:::::
::::::

:::::: column
::::: fact
::: fact-title
Fact 4
:::

::: fact-cont
$\mathbb{P}(A|B)$ is a probability, meaning that it satisfies the probability axioms. In particular, $$\mathbb{P}(A|B) + \mathbb{P}(A^C|B) = 1$$
:::
:::::
::::::
:::::::::::

## Conditional probability with two dice

::::::: columns
:::::: column
::::: example
::: ex-title
Example 3
:::

::: ex-cont
Two dice (green and blue) are rolled. If the dice do not show the same face, what is the probability that one of the dice is a 1?
:::
:::::
![](/lessons/img_slides/indep_2dice.png)
::::::
:::::::

## Conditional probability with two dice: simulations

::::: example
::: ex-title
Example 3
:::

::: ex-cont
Two dice (green and blue) are rolled. If the dice do not show the same face, what is the probability that one of the dice is a 1?
:::
:::::

```{r}
#| echo: true

set.seed(1002)
rolls = replicate(reps, sample(x = 1:6, size = 2, replace = TRUE))
rolls[, 1:10]

event_A = ( rolls[1, ] != rolls[2, ] )
head(event_A, 10)

event_B = ( rolls[1, ] == 1 | rolls[2, ] == 1 )
head(event_B, 10)

sum(event_B & event_A) / sum(event_A)
```

## Monty Hall Problem

[Survivor Season 42](https://www.youtube.com/watch?v=6JGyiISwY1k)

[With the Wiki page on it!](https://en.wikipedia.org/wiki/Monty_Hall_problem)

# Learning objectives

1.  Define independence of 2-3 events and decide whether two or more events are independent

2.  Define key facts for conditional probabilities and calculate conditional probabilities.

::: lob
3.  Calculate the probability of an event using Bayes' Theorem, Higher Order Multiplication Rule, and the Law of Total Probabilities
:::

## Bayes' Rule for two events

-   We can use the conditional probability ($\mathbb{P}(A|B)$) to get information on the flipped conditional probability ($\mathbb{P}(B|A)$)

::::::: columns
:::::: column
::::: theorem
::: thm-title
Theorem: Bayes' Rule (for two events)
:::

::: thm-cont
For any two events $A$ and $B$ with nonzero probabilties,

$$\mathbb{P}(A| B) = 
\frac{\mathbb{P}(A) \cdot \mathbb{P}(B|A)}
{\mathbb{P}(B)}$$
:::
:::::
::::::
:::::::

## Calculating probability with Higher Order Multiplication Rule

::::::::::: columns
:::::: column
::::: example
::: ex-title
Example 4
:::

::: ex-cont
Suppose we draw 5 cards from a standard shuffled deck of 52 cards. What is the probability of a flush, that is all the cards are of the same suit (including straight flushes)?
:::
:::::
::::::

:::::: column
::::: fact
::: fact-title
Higher Order Multiplication Rule
:::

::: fact-cont
$$\begin{aligned} \mathbb{P}(A_1\cap & A_2 \cap  \ldots \cap A_n)= \\ & \mathbb{P}(A_1)\cdot\mathbb{P}(A_2|A_1) \cdot \\
& \mathbb{P}(A_3|A_1A_2)\ldots \cdot\mathbb{P}(A_n|A_1A_2\ldots A_{n-1}) 
\end{aligned}$$
:::
:::::
::::::
:::::::::::

## Calculating probability with Law of Total Probability

::::::::::: columns
:::::: column
::::: example
::: ex-title
Example 5
:::

::: ex-cont
Suppose 1% of people assigned female at birth (AFAB) and 5% of people assigned male at birth (AMAB) are color-blind. Assume person born is equally likely AFAB or AMAB (not including intersex). What is the probability that a person chosen at random is color-blind?
:::
:::::
::::::

:::::: column
::::: fact
::: fact-title
Law of Total Probability for 2 Events
:::

::: fact-cont
For events $A$ and $B$,

$$%\left(
\begin{array}{ccl}
\mathbb{P}(B)&=&\mathbb{P}(B \cap A) + \mathbb{P}(B \cap A^C)\\
           &=& \mathbb{P}(B|A) \cdot \mathbb{P}(A)+ \mathbb{P}(B | A^C)\cdot \mathbb{P}(A^C)
\end{array}
%\right)$$
:::
:::::
::::::
:::::::::::

## General Law of Total Proability

::::: fact
::: fact-title
Law of Total Probability (general)
:::

::: fact-cont
If $\{A_i\}_{i=1}^{n} = \{A_1, A_2, \ldots, A_n\}$ form a partition of the sample space, then for event $B$,

$$%\left(
\begin{array}{ccl}
\mathbb{P}(B)&=& \sum_{i=1}^{n} \mathbb{P}(B \cap A_i)\\
           &=& \sum_{i=1}^{n} \mathbb{P}(B|A_i) \cdot \mathbb{P}(A_i)
\end{array}
%\right)$$
:::
:::::

## Calculating probability with generalized Law of Total Probability {.smaller}

![](../img_slides/Chp_05_ex_03.jpeg){fig-align="center"}

## Calculating probability with generalized Law of Total Probability {visibility="hidden"}

:::::::: columns
:::::: {.column width="40%"}
::::: example
::: ex-title
Example 3
:::

::: ex-cont
Individuals are diagnosed with a particular type of cancer that can take on three different disease forms,\* $D_1$, $D_2$, and $D_3$. It is known that amongst people diagnosed with this particular type of cancer,

-   20% of people will eventually be diagnosed with form $D_1$,

-   30% with form $D_2$, and

-   50% with form $D_3$.

The probability of requiring chemotherapy ($C$) differs among the three forms of disease:

-   80% with $D_1$,

-   30% with $D_2$, and

-   10% with $D_3$.

Based solely on the preliminary test of being diagnosed with the cancer, what is the probability of requiring chemotherapy (the event C)?
:::
:::::
::::::

::: column
Skipping in class! Let me know if you would like me to post solutions to this if you work through it!
:::
::::::::

## Let's revisit the color-blind example {visibility="hidden"}

::::::: columns
:::::: {.column width="40%"}
::::: example
::: ex-title
Example 4
:::

::: ex-cont
Recall the color-blind example (Example [2](#Ex_colorblind){reference-type="ref" reference="Ex_colorblind"}), where

-   a person is AMAB with probability 0.5,

-   AMAB people are color-blind with probability 0.05, and

-   all people are color-blind with probability 0.03.

Assuming people are AMAB or AFAB, find the probability that a color-blind person is AMAB.
:::
:::::
::::::
:::::::

## Calculate probability with both rules

::::::: columns
:::::: {.column width="40%"}
::::: example
::: ex-title
Example 6
:::

::: ex-cont
Suppose

-   1% of people who are AFAB aged 40-50 years have breast cancer,

-   an AFAB person with breast cancer has a 90% chance of a positive test from a mammogram, and

-   an AFAB person has a 10% chance of a false-positive result from a mammogram.

What is the probability that an AFAB person has breast cancer given that they just had a positive test?
:::
:::::
::::::
:::::::

## Bayes' Rule

::::: theorem
::: thm-title
Theorem: Bayes' Rule
:::

::: thm-cont
If $\{A_i\}_{i=1}^{n}$ form a partition of the sample space $S$, with $\mathbb{P}(A_i)>0$ for $i=1\ldots n$ and $\mathbb{P}(B)>0$, then

$$\mathbb{P}(A_j | B) = 
\frac{\mathbb{P}(B|A_j) \cdot \mathbb{P}(A_j)}
{\sum_{i=1}^{n} \mathbb{P}(B|A_i) \cdot \mathbb{P}(A_i)}$$
:::
:::::
