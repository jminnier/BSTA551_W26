{
  "hash": "bd92accd7085f199487ab90648e24857",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lesson 7: Probability Mass Functions (pmf's)\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#006a4e\"\ndate: \" 2026-01-26 \"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 7 Slides\n    html-math-method: mathjax\n---\n\n# Learning Objectives\n\n1. Identify a probability mass function (pmf) from past simulations\n2. Identify a binomial random variable and its parameters from a word problem\n3. Use R to calculate probabilities and simulate binomial random variables\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n\n\n# Learning Objectives\n\n::: lob\n1. Identify a probability mass function (pmf) from past simulations\n:::\n\n2. Identify a binomial random variable and its parameters from a word problem\n3. Use R to calculate probabilities and simulate binomial random variables\n\n## From Lesson 2: Types of random variables\n\nThere are two types of random variables:\n\n::: columns\n::: column\n\n::: theorem\n::: thm-cont\n-   [**Discrete random variables** (RVs)]{style=\"color:#20c997;\"}: the set of possible values is either finite or can be put into a countably infinite list\n\n    -   You could *theoretically* list the specific possible outcomes that the variable can take\n\n    -   If you sum the rolls of three dice, you must get a whole number. For example, you can't get any number between 3 and 4.\n:::\n:::\n\n:::\n::: column\n\n::: axiom\n::: axiom-cont\n-   [**Continuous random variables** (RVs)]{style=\"color:#d9534f;\"}: take on values from continuous *intervals*, or unions of continuous intervals\n\n    -   Variable takes on a range of values, but there are infinitely possible values within the range\n\n    -   If you keep track of the time you sleep, you can sleep for 8 hours or 7.9 hours or 7.99 hours or 7.999 hours ...\n:::\n:::\n:::\n:::\n\n-   **Discrete random variables** (RVs) are a little easier to simulate right now\n    - We will only do discrete RVs today\n\n## What is a probability mass function?\n\n::: definition\n::: def-title\nDefinition: probability distribution or probability mass function (pmf)\n:::\n\n::: def-cont\nThe **probability distribution** or **probability mass function** (**pmf**) of a discrete r.v. $X$ is defined for every number $x$ by $$p_X(x) = \\mathbb{P}(X=x) = \\mathbb{P}(\\mathrm{all }\\ \\omega\\in S:X(\\omega) = x)$$\n:::\n:::\n\n## From Lesson 2: Simulating two rolls (1/2)\n\n::::: example\n::: ex-title\nExample: Simulating Two Rolls of a Fair Four-Sided Die\n:::\n\n::: ex-cont\nWe're going to roll two four-sided die. Let $X$ be the sum of two rolls. How would we simulate $X$?\n:::\n:::::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreps <- 100000\nsimulations <- replicate(reps, sample(x = 1:4, size = 2, replace = TRUE))\n```\n:::\n\n\n- Let's show the first 14 simulations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimulations[, 1:14]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]\n[1,]    1    2    1    2    3    4    2    3    3     2     1     4     3     3\n[2,]    4    3    2    2    3    1    4    2    4     3     4     1     3     4\n```\n\n\n:::\n:::\n\n\n\n- $X$ is the sum of the two rolls: we could calculate that for each column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX_simulated <- apply(simulations, 2, sum)\nX_simulated[1:14]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 5 5 3 4 6 5 6 5 7 5 5 5 6 7\n```\n\n\n:::\n:::\n\n\n## From Lesson 2: Simulating two rolls (2/2)\n\n::: columns\n::: {.column width=\"55%\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plot simulated distribution of X\"}\nX_df <- as.data.frame(X_simulated) %>%\n  rename(X = X_simulated)\n\nggplot(X_df, aes(x = X, after_stat(density))) +\n  geom_histogram(binwidth = 1, color = \"black\", fill = \"lightblue\") +\n  scale_x_continuous(breaks = seq(2, 8, by = 1)) +\n  labs(title = \"Simulated Distribution of X (Sum of Two Rolls)\",\n       x = \"Value of X\",\n       y = \"Approximated probablity\")\n```\n\n::: {.cell-output-display}\n![](07_pmfs_files/figure-html/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n:::\n::: {.column width=\"45%\"}\n- For the RV $X$, we can find the probability for each possible value, $P(X=x) = p_X(x)$:\n$$\np_X(x) =\n\\begin{cases}\n\\frac{4-|x-5|}{16}, & x = 2, 3, 4, 5, 6,7, 8,\\\\\n0, & \\text{otherwise}\n\\end{cases}\n$$\n:::\n:::\n\n## Remarks on the pmf\n\n::: axiom\n::: axiom-title\nProperties of pmf\n:::\n\n::: axiom-cont\nA pmf $p_X(x)$ must satisfy the following properties:\n\n-   $0 \\leq p_X(x) \\leq 1$ for all $x$\n\n-   $\\sum \\limits_{\\{all\\ x\\}}p_X(x)=1$\n:::\n:::\n\n-   Some distributions depend on parameters\n\n    -   Each value of a parameter gives a **different** pmf\n\n    -   In previous example, the number of dice rolled was a parameter\n\n        -   We rolled 2 dice\n\n        -   If we rolled 4 dice, we'd get a **different** pmf!\n\n    -   The collection of all pmf's *for different values of the parameters* is called a **family** of pmf's\n\n# Learning Objectives\n\n1. Identify a probability mass function (pmf) from past simulations\n\n::: lob\n2. Identify a binomial random variable and its parameters from a word problem\n:::\n\n3. Use R to calculate probabilities and simulate binomial random variables\n\n## Binomial random variables\n\n-   **One specific type of discrete random variable** is a binomial random variable\n\n::::: definition\n::: def-title\nBinomial random variable\n:::\n\n::: def-cont\n-   $X$ is a binomial random variable if it represents the number of successes in $n$ independent replications (or trials) of an experiment where\n\n    -   Each replicate has two possible outcomes: either **success** or **failure**\n    -   The probability of success is $p$\n    -   The probability of failure is $q=1-p$\n:::\n:::::\n\n-   A binomial random variable takes on values $0, 1, 2, \\dots, n$.\n\n-   If a r.v. $X$ is modeled by a Binomial distribution, then we write in shorthand $X \\sim \\text{Binom}(n,p)$\n\n-   Quick example: The number of heads in 3 tosses of a fair coin is a binomial random variable with parameters $n = 3$ and $p = 0.5$.\n\n## Binomial family of distributions\n\n::::: definition\n::: def-title\nDistribution (or pmf) of a **Binomial** random variable\n:::\n\n::: def-cont\nLet $X$ be the total number of successes in $n$ independent trials, each with probability $p$ of a success. Then probability of observing exactly $k$ successes in $n$ independent trials is \n\n$$P(X = x) = \\binom{n}{x} p^x (1-p)^{n-x},  x= 0, 1, 2, \\dots, n $$\n\n:::\n:::::\n\n-   The parameters of a binomial distribution are $p$ and $n$.\n\n## Binomial distribution: R commands\n\nR commands with their [input]{style=\"color:#BF396F\"} and [output]{style=\"color:#367B79\"}:\n\n::: columns\n::: column\n\n| R code     | What does it return?                                                                                                         |\n|--------------------|----------------------------------------------------|\n| `rbinom()` | returns [sample of random variables]{style=\"color:#367B79\"} with [specified binomial distribution]{style=\"color:#BF396F\"}    |\n| `dbinom()` | returns [probability]{style=\"color:#367B79\"} of getting [certain number of successes]{style=\"color:#BF396F\"}                 |\n| `pbinom()` | returns [cumulative probability]{style=\"color:#367B79\"} of getting [certain number or less]{style=\"color:#BF396F\"} successes |\n| `qbinom()` | returns [number of successes]{style=\"color:#367B79\"} corresponding to [desired quantile]{style=\"color:#BF396F\"}              |\n:::\n::: column\n:::\n:::\n\n# Learning Objectives\n\n1. Identify a probability mass function (pmf) from past simulations\n2. Identify a binomial random variable and its parameters from a word problem\n\n::: lob\n3. Use R to calculate probabilities and simulate binomial random variables\n:::\n\n## Falls in Older Adults (1/5)\n\n::: columns\n::: {.column width=\"100%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\nA major public health concern is falls among older adults (age 65+). National data suggests that 25% of older adults will experience at least one fall within a given year. A community health program is tracking a random group of $n = 8$ older adults for one year. Assume the likelihood of falling is independent from person to person.\n\nLet $X$ be the random variable representing the number of individuals in this group who experience at least one fall.\n\n1. What is the sample space for the random variable $X$?\n2. Write the probability mass function (pmf) for $X$. \n3. Use R to calculate the probability for each possible value of $X$.\n4. Make a bar plot of the pmf.\n5. Simulate $X$ for 10000 groups and plot the approximated pmf.\n:::\n:::\n:::\n:::\n\n## Falls in Older Adults (2/5)\n\n::: columns\n::: {.column width=\"50%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n1. What is the sample space for the random variable $X$?\n:::\n:::\n:::\n:::\n\n## Falls in Older Adults (3/5)\n\n::: columns\n::: {.column width=\"50%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n2. Write the probability mass function (pmf) for $X$. \n:::\n:::\n:::\n:::\n\n$$P(X = x) = \\binom{n}{x} p^x (1-p)^{n-x},  x= 0, 1, 2, \\dots, n $$\n\n## Falls in Older Adults (4/6)\n\n::: columns\n::: {.column width=\"50%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n3. Use R to calculate the probability for each possible value of $X$.\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 8\np = 0.25\n\ndbinom(0, size = n, prob = p)  #P(X=0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1001129\n```\n\n\n:::\n\n```{.r .cell-code}\nfalls <- tibble(\n  x = 0:n,\n  prob = dbinom(x, size = n, prob = p)\n)\n```\n:::\n\n\n:::\n\n::: column\n\n \n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfalls\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 2\n      x      prob\n  <int>     <dbl>\n1     0 0.100    \n2     1 0.267    \n3     2 0.311    \n4     3 0.208    \n5     4 0.0865   \n6     5 0.0231   \n7     6 0.00385  \n8     7 0.000366 \n9     8 0.0000153\n```\n\n\n:::\n:::\n\n\n:::\n:::\n\n## Falls in Older Adults (5/6)\n\n::: columns\n::: {.column width=\"50%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n4. Make a bar plot of the pmf.\n:::\n\n:::\n:::\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot(falls, aes(x = x, y = prob)) +\n  geom_col() + \n  labs(\n    title = \"Probability mass function (pmf) of X\",\n    x = \"Number of adults (x)\",\n    y = \"Probability\"\n  ) \n```\n\n::: {.cell-output-display}\n![](07_pmfs_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=864}\n:::\n:::\n\n\n\n## Falls in Older Adults (6/6)\n\n::: columns\n::: {.column width=\"50%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n5. Simulate $X$ for 10000 groups and plot the approximated pmf.\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4764)\nreps = 10000\n\nsims = rbinom(n = reps, \n              size = n, \n              prob = p)\n\nsims %>% head(., 14)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 2 1 2 1 3 3 2 2 4 2 3 0 2 0\n```\n\n\n:::\n\n```{.r .cell-code}\nfalls2 <- tibble(x = 0:n) %>%\n  rowwise() %>%\n  mutate(prob = sum(sims == x) / reps)\n```\n:::\n\n\n:::\n\n::: column\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(falls2, aes(x = x, y = prob)) +\n  geom_col() + \n  labs(\n    title = \"Approximate probability mass function (pmf) of X\",\n    x = \"Number of adults (x)\",\n    y = \"Approximate Probability\"\n  ) \n```\n\n::: {.cell-output-display}\n![](07_pmfs_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=864}\n:::\n:::\n\n:::\n\n:::\n\n\n",
    "supporting": [
      "07_pmfs_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}