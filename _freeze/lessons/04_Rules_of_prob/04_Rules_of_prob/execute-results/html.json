{
  "hash": "ab2fd64d7f9a05d151787c8cf76308fe",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lesson 4: Rules of probability\"\nauthor: \"Meike Niederhausen and Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#006a4e\"\ndate: \" 2025-10-08 \"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 4 Slides\n    html-math-method: mathjax\n---\n\n\n\n\n\n# Learning objectives\n\n1.  Define independence of 2-3 events and decide whether two or more events are independent\n\n2.  Define key facts for conditional probabilities and calculate conditional probabilities.\n\n3.  Calculate the probability of an event using Bayes' Theorem, Higher Order Multiplication Rule, and the Law of Total Probabilities\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n## General Process for Probability Word Problems\n\n1.  Clearly define your events of interest\n\n2.  Translate question to probability using defined events OR Venn Diagram\n\n3.  Ask yourself:\n\n    -   Are we sampling with or without replacement?\n\n    -   Does order matter?\n\n4.  Use axioms, properties, partitions, facts, etc. to define the end probability calculation into smaller parts\n\n    -   If probabilities are given to you, Venn Diagrams may help you parse out the events and probability calculations\n\n    -   If you need to find probabilities with counting, pictures or diagrams might help here\n\n5.  Write out a concluding statement that gives the probability context\n\n6.  (For own check) Make sure the calculated probability follows the axioms. Is is between 0 and 1?\n\n# Learning objectives\n\n::: lob\n1.  Define independence of 2-3 events and decide whether two or more events are independent\n:::\n\n2.  Define key facts for conditional probabilities and calculate conditional probabilities.\n\n3.  Calculate the probability of an event using Bayes' Theorem, Higher Order Multiplication Rule, and the Law of Total Probabilities\n\n## Independent Events\n\n::::: definition\n::: def-title\nDefinition: Independence\n:::\n\n::: def-cont\nEvents $A$ and $B$ are **independent** if $$\\mathbb{P}(A \\cap B) = \\mathbb{P}(A) \\cdot  \\mathbb{P}(B).$$\n:::\n:::::\n\n**Notation:** For shorthand, we sometimes write $A \\mathrel{\\unicode{x2AEB}} B,$ to denote that $A$ and $B$ are independent events.\n\nÂ \n\n-   Also note: $$\\begin{aligned} \\mathbb{P}(A \\cap B) = \\mathbb{P}(A) \\cdot  \\mathbb{P}(B) & \\implies A \\mathrel{\\unicode{x2AEB}} B \\\\\n    A \\mathrel{\\unicode{x2AEB}} B & \\implies \\mathbb{P}(A \\cap B) = \\mathbb{P}(A) \\cdot  \\mathbb{P}(B) \\end{aligned}$$\n\n## Example of two dice\n\n::::: example\n::: ex-title\nExample 1\n:::\n\n::: ex-cont\nTwo dice (green and blue) are rolled. Let $A =$ event a total of 7 appears, and $B =$ event green die is a six. Are events $A$ and $B$ independent?\n:::\n:::::\n\n![](/lessons/img_slides/indep_2dice.png)\n\n## Example of two dice: simulating in R (1/2)\n\n::::: example\n::: ex-title\nExample 1\n:::\n\n::: ex-cont\nTwo dice (green and blue) are rolled. Let $A =$ event a total of 7 appears, and $B =$ event green die is a six. Are events $A$ and $B$ independent?\n:::\n:::::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1002)\nreps = 10000\nrolls = replicate(reps, sample(x = 1:6, size = 2, replace = TRUE))\nrolls[, 1:10]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n[1,]    4    5    5    5    6    5    2    4    3     4\n[2,]    1    4    6    3    1    1    5    5    6     3\n```\n\n\n:::\n\n```{.r .cell-code}\nevent_A = ( rolls[1, ] + rolls[2, ] == 7 )\nhead(event_A, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nevent_B = ( rolls[1, ] == 6 )\nhead(event_B, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE\n```\n\n\n:::\n:::\n\n\n\n## Example of two dice: simulating in R (1/2)\n\n::::: example\n::: ex-title\nExample 1\n:::\n\n::: ex-cont\nTwo dice (green and blue) are rolled. Let $A =$ event a total of 7 appears, and $B =$ event green die is a six. Are events $A$ and $B$ independent?\n:::\n:::::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n( sum(event_A) / reps ) * ( sum(event_B) / reps )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0286608\n```\n\n\n:::\n\n```{.r .cell-code}\nevent_A_and_B = ( rolls[1, ] + rolls[2, ] == 7 ) & ( rolls[1, ] == 6 )\nhead(event_A_and_B, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(event_A_and_B) / reps\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0284\n```\n\n\n:::\n:::\n\n\n\n## Independence of 3 Events\n\n::::: definition\n::: def-title\nDefinition: Independence of 3 Events\n:::\n\n::: def-cont\n*Events* $A$, $B$, and $C$ are *mutually* **independent** if\n\n1.  \n\n    -   $\\mathbb{P}(A \\cap B) = \\mathbb{P}(A) \\cdot \\mathbb{P}(B)$\n\n    -   $\\mathbb{P}(A \\cap C) = \\mathbb{P}(A) \\cdot \\mathbb{P}(C)$\n\n    -   $\\mathbb{P}(B \\cap C) = \\mathbb{P}(B) \\cdot \\mathbb{P}(C)$\n\n2.  $\\mathbb{P}(A \\cap B \\cap C) = \\mathbb{P}(A) \\cdot \\mathbb{P}(B) \\cdot \\mathbb{P}(C)$\n:::\n:::::\n\n**Remark:**\n\nOn your homework you will show that $(1) \\not \\Rightarrow (2)$ and $(2) \\not \\Rightarrow (1)$.\n\n## Probability at least one smoker\n\n::::::: columns\n:::::: {.column width=\"34%\"}\n::::: example\n::: ex-title\nExample 2\n:::\n\n::: ex-cont\nSuppose you take a random sample of $n$ people, of which people are smokers and non-smokers independently of each other. Let\n\n-   $A_i =$ event person $i$ is a smoker, for $i=1, \\ldots ,n$, and\n\n-   $p_i =$ probability person $i$ is a smoker, for $i=1, \\ldots ,n$.\n\nFind the probability that at least one person in the random sample is a smoker.\n:::\n:::::\n::::::\n:::::::\n\n## Building geometric series {visibility=\"hidden\"}\n\n::::: example\n::: ex-title\nExample 3\n:::\n\n::: ex-cont\n$A, B,$ and $C$ toss a fair coin in order. The first to throw heads wins. What are their respective chances of winning?\n:::\n:::::\n\nLet\n\n-   $A_H$ and $A_T$ be the events player A tosses heads and tails, respectively.\n\n-   Similarly define $B_H$, $B_T$, $C_H$, and $C_T$.\n\n# Learning objectives\n\n1.  Define independence of 2-3 events and decide whether two or more events are independent\n\n::: lob\n2.  Define key facts for conditional probabilities and calculate conditional probabilities.\n:::\n\n3.  Calculate the probability of an event using Bayes' Theorem, Higher Order Multiplication Rule, and the Law of Total Probabilities\n\n## Let's revisit our deck of cards {visibility=\"hidden\"}\n\n:::::::: columns\n:::::: {.column width=\"35%\"}\n::::: example\n::: ex-title\nExample 1\n:::\n\n::: ex-cont\nSuppose we randomly draw 2 cards from a standard deck of cards. What is the probability that we draw a spade then a heart?\n:::\n:::::\n\nLet\n\n-   Let $A =$ event $1^{st}$ card is spades\n\n-   Let $B =$ event $2^{nd}$ card is heart\n::::::\n\n::: column\n:::\n::::::::\n\n## Conditional Probability facts (1/2)\n\n::::::::::: columns\n:::::: column\n::::: fact\n::: fact-title\nFact 1: General Multiplication Rule\n:::\n\n::: fact-cont\n$$\\mathbb{P}(A\\cap B)=\\mathbb{P}(A)\\cdot\\mathbb{P}(B|A)$$\n:::\n:::::\n::::::\n\n:::::: column\n::::: fact\n::: fact-title\nFact 2: Conditional Probability Definition\n:::\n\n::: fact-cont\n$$\\mathbb{P}(A|B)=\\frac{\\mathbb{P}(A\\cap B)}{\\mathbb{P}(B)}$$\n:::\n:::::\n::::::\n:::::::::::\n\n## Conditional Probability facts (2/2)\n\n::::::::::: columns\n:::::: column\n::::: fact\n::: fact-title\nFact 3\n:::\n\n::: fact-cont\nIf $A$ and $B$ are independent events ($A \\unicode{x2AEB}B$), then $$\\mathbb{P}(A|B) = \\mathbb{P}(A)$$\n:::\n:::::\n::::::\n\n:::::: column\n::::: fact\n::: fact-title\nFact 4\n:::\n\n::: fact-cont\n$\\mathbb{P}(A|B)$ is a probability, meaning that it satisfies the probability axioms. In particular, $$\\mathbb{P}(A|B) + \\mathbb{P}(A^C|B) = 1$$\n:::\n:::::\n::::::\n:::::::::::\n\n## Conditional probability with two dice\n\n::::::: columns\n:::::: column\n::::: example\n::: ex-title\nExample 3\n:::\n\n::: ex-cont\nTwo dice (green and blue) are rolled. If the dice do not show the same face, what is the probability that one of the dice is a 1?\n:::\n:::::\n![](/lessons/img_slides/indep_2dice.png)\n::::::\n:::::::\n\n## Conditional probability with two dice: simulations\n\n::::: example\n::: ex-title\nExample 3\n:::\n\n::: ex-cont\nTwo dice (green and blue) are rolled. If the dice do not show the same face, what is the probability that one of the dice is a 1?\n:::\n:::::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1002)\nrolls = replicate(reps, sample(x = 1:6, size = 2, replace = TRUE))\nrolls[, 1:10]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n[1,]    4    5    5    5    6    5    2    4    3     4\n[2,]    1    4    6    3    1    1    5    5    6     3\n```\n\n\n:::\n\n```{.r .cell-code}\nevent_A = ( rolls[1, ] != rolls[2, ] )\nhead(event_A, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nevent_B = ( rolls[1, ] == 1 | rolls[2, ] == 1 )\nhead(event_B, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(event_B & event_A) / sum(event_A)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3315328\n```\n\n\n:::\n:::\n\n\n\n## Monty Hall Problem\n\n[Survivor Season 42](https://www.youtube.com/watch?v=6JGyiISwY1k)\n\n[With the Wiki page on it!](https://en.wikipedia.org/wiki/Monty_Hall_problem)\n\n# Learning objectives\n\n1.  Define independence of 2-3 events and decide whether two or more events are independent\n\n2.  Define key facts for conditional probabilities and calculate conditional probabilities.\n\n::: lob\n3.  Calculate the probability of an event using Bayes' Theorem, Higher Order Multiplication Rule, and the Law of Total Probabilities\n:::\n\n## Bayes' Rule for two events\n\n-   We can use the conditional probability ($\\mathbb{P}(A|B)$) to get information on the flipped conditional probability ($\\mathbb{P}(B|A)$)\n\n::::::: columns\n:::::: column\n::::: theorem\n::: thm-title\nTheorem: Bayes' Rule (for two events)\n:::\n\n::: thm-cont\nFor any two events $A$ and $B$ with nonzero probabilties,\n\n$$\\mathbb{P}(A| B) = \n\\frac{\\mathbb{P}(A) \\cdot \\mathbb{P}(B|A)}\n{\\mathbb{P}(B)}$$\n:::\n:::::\n::::::\n:::::::\n\n## Calculating probability with Higher Order Multiplication Rule\n\n::::::::::: columns\n:::::: column\n::::: example\n::: ex-title\nExample 4\n:::\n\n::: ex-cont\nSuppose we draw 5 cards from a standard shuffled deck of 52 cards. What is the probability of a flush, that is all the cards are of the same suit (including straight flushes)?\n:::\n:::::\n::::::\n\n:::::: column\n::::: fact\n::: fact-title\nHigher Order Multiplication Rule\n:::\n\n::: fact-cont\n$$\\begin{aligned} \\mathbb{P}(A_1\\cap & A_2 \\cap  \\ldots \\cap A_n)= \\\\ & \\mathbb{P}(A_1)\\cdot\\mathbb{P}(A_2|A_1) \\cdot \\\\\n& \\mathbb{P}(A_3|A_1A_2)\\ldots \\cdot\\mathbb{P}(A_n|A_1A_2\\ldots A_{n-1}) \n\\end{aligned}$$\n:::\n:::::\n::::::\n:::::::::::\n\n## Calculating probability with Law of Total Probability\n\n::::::::::: columns\n:::::: column\n::::: example\n::: ex-title\nExample 5\n:::\n\n::: ex-cont\nSuppose 1% of people assigned female at birth (AFAB) and 5% of people assigned male at birth (AMAB) are color-blind. Assume person born is equally likely AFAB or AMAB (not including intersex). What is the probability that a person chosen at random is color-blind?\n:::\n:::::\n::::::\n\n:::::: column\n::::: fact\n::: fact-title\nLaw of Total Probability for 2 Events\n:::\n\n::: fact-cont\nFor events $A$ and $B$,\n\n$$%\\left(\n\\begin{array}{ccl}\n\\mathbb{P}(B)&=&\\mathbb{P}(B \\cap A) + \\mathbb{P}(B \\cap A^C)\\\\\n           &=& \\mathbb{P}(B|A) \\cdot \\mathbb{P}(A)+ \\mathbb{P}(B | A^C)\\cdot \\mathbb{P}(A^C)\n\\end{array}\n%\\right)$$\n:::\n:::::\n::::::\n:::::::::::\n\n## General Law of Total Proability\n\n::::: fact\n::: fact-title\nLaw of Total Probability (general)\n:::\n\n::: fact-cont\nIf $\\{A_i\\}_{i=1}^{n} = \\{A_1, A_2, \\ldots, A_n\\}$ form a partition of the sample space, then for event $B$,\n\n$$%\\left(\n\\begin{array}{ccl}\n\\mathbb{P}(B)&=& \\sum_{i=1}^{n} \\mathbb{P}(B \\cap A_i)\\\\\n           &=& \\sum_{i=1}^{n} \\mathbb{P}(B|A_i) \\cdot \\mathbb{P}(A_i)\n\\end{array}\n%\\right)$$\n:::\n:::::\n\n## Calculating probability with generalized Law of Total Probability {.smaller}\n\n![](../img_slides/Chp_05_ex_03.jpeg){fig-align=\"center\"}\n\n## Calculating probability with generalized Law of Total Probability {visibility=\"hidden\"}\n\n:::::::: columns\n:::::: {.column width=\"40%\"}\n::::: example\n::: ex-title\nExample 3\n:::\n\n::: ex-cont\nIndividuals are diagnosed with a particular type of cancer that can take on three different disease forms,\\* $D_1$, $D_2$, and $D_3$. It is known that amongst people diagnosed with this particular type of cancer,\n\n-   20% of people will eventually be diagnosed with form $D_1$,\n\n-   30% with form $D_2$, and\n\n-   50% with form $D_3$.\n\nThe probability of requiring chemotherapy ($C$) differs among the three forms of disease:\n\n-   80% with $D_1$,\n\n-   30% with $D_2$, and\n\n-   10% with $D_3$.\n\nBased solely on the preliminary test of being diagnosed with the cancer, what is the probability of requiring chemotherapy (the event C)?\n:::\n:::::\n::::::\n\n::: column\nSkipping in class! Let me know if you would like me to post solutions to this if you work through it!\n:::\n::::::::\n\n## Let's revisit the color-blind example {visibility=\"hidden\"}\n\n::::::: columns\n:::::: {.column width=\"40%\"}\n::::: example\n::: ex-title\nExample 4\n:::\n\n::: ex-cont\nRecall the color-blind example (Example [2](#Ex_colorblind){reference-type=\"ref\" reference=\"Ex_colorblind\"}), where\n\n-   a person is AMAB with probability 0.5,\n\n-   AMAB people are color-blind with probability 0.05, and\n\n-   all people are color-blind with probability 0.03.\n\nAssuming people are AMAB or AFAB, find the probability that a color-blind person is AMAB.\n:::\n:::::\n::::::\n:::::::\n\n## Calculate probability with both rules\n\n::::::: columns\n:::::: {.column width=\"40%\"}\n::::: example\n::: ex-title\nExample 6\n:::\n\n::: ex-cont\nSuppose\n\n-   1% of people who are AFAB aged 40-50 years have breast cancer,\n\n-   an AFAB person with breast cancer has a 90% chance of a positive test from a mammogram, and\n\n-   an AFAB person has a 10% chance of a false-positive result from a mammogram.\n\nWhat is the probability that an AFAB person has breast cancer given that they just had a positive test?\n:::\n:::::\n::::::\n:::::::\n\n## Bayes' Rule\n\n::::: theorem\n::: thm-title\nTheorem: Bayes' Rule\n:::\n\n::: thm-cont\nIf $\\{A_i\\}_{i=1}^{n}$ form a partition of the sample space $S$, with $\\mathbb{P}(A_i)>0$ for $i=1\\ldots n$ and $\\mathbb{P}(B)>0$, then\n\n$$\\mathbb{P}(A_j | B) = \n\\frac{\\mathbb{P}(B|A_j) \\cdot \\mathbb{P}(A_j)}\n{\\sum_{i=1}^{n} \\mathbb{P}(B|A_i) \\cdot \\mathbb{P}(A_i)}$$\n:::\n:::::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}