{
  "hash": "828fb3922956846cb24483fadfbf93cc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lesson 2: Introduction to Simulations\"\nauthor: \"Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#006a4e\"\ndate: \"2025-10-01\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 2 Slides\n    html-math-method: mathjax\n    highlight-style: atom-one\n    echo: true\n---\n\n\n\n\n\n# Learning Objectives\n\n1. Describe random variables and distinguish between discrete and continuous types\n2. Explain the role of simulation in approximating probabilities and distributions\n3. Use R to run simulations of discrete random variables\n4. Apply and interpret the four-step simulation process\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n# Learning Objectives\n\n::: lob\n1. Describe random variables and distinguish between discrete and continuous types\n:::\n\n2. Explain the role of simulation in approximating probabilities and distributions\n3. Use R to run simulations of discrete random variables\n4. Apply and interpret the four-step simulation process\n\n## Recall: Outcomes, events, sample spaces\n\n::::: definition\n::: def-title\nDefinition: Outcome\n:::\n\n::: def-cont\nThe possible results in a random phenomenon.\n:::\n:::::\n\n::::: definition\n::: def-title\nDefinition: Sample Space\n:::\n\n::: def-cont\nThe **sample space** $S$ is the set of *all* outcomes\n:::\n:::::\n\n::::: definition\n::: def-title\nDefinition: Event\n:::\n\n::: def-cont\nAn **event** is a *collection of some* outcomes. An event can include multiple outcomes or no outcomes (a subset of the sample space).\n:::\n:::::\n\nWhen thinking about events, think about outcomes that you might be asking the probability of. For example, what is the probability that you get a heads or a tails in one flip? (Answer: 1)\n\n## We need to understand random variables \n\n::: definition\n::: def-title\nDefinition: Random Variable\n:::\n\n::: def-cont\nFor a given sample space $S$, a **random variable** (r.v.) is a **function** whose domain is $S$ and whose range is the set of real numbers $\\mathbb{R}$. **A random variable assigns a real number to each outcome in the sample space.**\n:::\n:::\n\n-   A random variable's value is completely determined by the outcome $\\omega$, where $\\omega \\in S$\n\n    -   What is *random* is the outcome $\\omega$\n\n-   A **random variable** is a function from the sample space (with outcomes $\\omega$) to the set of real numbers\n\n    -   We typically write $X(\\omega)$ (or $X$ for short), where $X$ is our random variable\n    \n- Thus, we can take our sample space (all outcomes) and make functional transformations to it\n\n## The cool (and tricky) thing about random variables\n\nDo you remember our coin example from Lesson 1? We tossed one or two coins.\n\n- For each coin, the **sample space** is heads and tails ($S = \\{H,T\\}$)\n- If we want the **sample space** for both coins in order, then we have combinations ($S=\\{(H,H), (H,T), (T,H), (T,T)\\}$)\n\n \n\nWe make the **random variable** a *function* of the **sample space**.\n\n- For one coin toss, we can say random variable $X$ is $1$ if we toss a heads ($\\omega = \\text{H}$) and $X=0$ if we get a tails\n- For the two coins, we can say $X$ is the count of heads, so if $\\omega = \\text{(H, T)}$, then $X=1$\n    \n## Types of random variables\n\nThere are two types of random variables:\n\n::: columns\n::: column\n\n::: theorem\n::: thm-cont\n-   [**Discrete random variables** (RVs)]{style=\"color:#20c997;\"}: the set of possible values is either finite or can be put into a countably infinite list\n\n    -   You could *theoretically* list the specific possible outcomes that the variable can take\n\n    -   If you sum the rolls of three dice, you must get a whole number. For example, you can't get any number between 3 and 4.\n:::\n:::\n\n:::\n::: column\n\n::: axiom\n::: axiom-cont\n-   [**Continuous random variables** (RVs)]{style=\"color:#d9534f;\"}: take on values from continuous *intervals*, or unions of continuous intervals\n\n    -   Variable takes on a range of values, but there are infinitely possible values within the range\n\n    -   If you keep track of the time you sleep, you can sleep for 8 hours or 7.9 hours or 7.99 hours or 7.999 hours ...\n:::\n:::\n:::\n:::\n\n-   **Discrete random variables** (RVs) are a little easier to simulate right now\n    - We will only do discrete RVs today\n\n\n# Learning Objectives \n\n1. Describe random variables and distinguish between discrete and continuous types\n\n::: lob\n2. Explain the role of simulation in approximating probabilities and distributions\n:::\n\n3. Use R to run simulations of discrete random variables\n4. Apply and interpret the four-step simulation process\n\n## What is a simulation?\n\nA **probability model** for a random phenomenon includes a sample space, events, random variables, and a probability measure.\n\n::::: definition\n::: def-title\nSimulation\n:::\n\n::: def-cont\n**Simulation** involves using a probability model to artificially recreate a random phenomenon, many times, usually using a computer.\n:::\n:::::\n\nWe simulate outcomes and values of random variables according to the model's assumptions.\n\n## The Foundation: Relative Frequencies\n\n-   Probabilities can be interpreted as **long-run relative frequencies**\n\n \n\n-   By simulating a random phenomenon a large number of times, we can approximate the probability of an event by calculating the relative frequency of its occurrence\n    - Basically, out of all the trials we run, how many times did the event happen?\n\n \n\n-   Simulation is a powerful tool to **approximate a few things**:\n    - Probabilities\n    - Distributions of random variables\n    - Long-run averages\n\n## We saw an example of long-run relative frequency in our coin flip \n\nIn Lesson 1, we flipped a coin 100 times and recorded the proportion of heads.\n\n- We tossed 50 heads out of the 100 flips\n- Our long-run frequency was $50/100 = 0.5$, which **approximated the probability** of getting a head on any one flip\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: columns\n::: {.column width=\"30%\"}\n![](../img_slides/coin_flip.png){fig-align=\"center\"}\n:::\n::: {.column width=\"70%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03_Simulations_files/figure-revealjs/coin-flips-plot-1.png){width=1248}\n:::\n:::\n\n\n\n:::\n:::\n\n## Tactile simulations\n\n-   We've already seen coin flips!\n-   We can also use cards, dice, and other objects to simulate discrete random variables\n\n \n\n-   Other common method: A **box model** uses a box/hat/bucket of \"tickets\" with labels to represent possible outcomes\n    -   Allows us to increase the number of \"tickets\" with appropriate labels\n    -   **Coin flip as box model:** A box with two tickets (H and T).\n    -   **90% free throw shooter:** A box with 10 tickets (9 \"make\" and 1 \"miss\").\n    -   Draws can be **with replacement** (e.g., coin flips) or **without replacement** (e.g., dealing a poker hand).\n\n# Learning objectives\n\n1. Describe random variables and distinguish between discrete and continuous types\n2. Explain the role of simulation in approximating probabilities and distributions\n\n::: lob\n3. Use R to run simulations of discrete random variables\n:::\n\n4. Apply and interpret the four-step simulation process\n\n## Example to build our simulation skills\n\n::::: example\n::: ex-title\nExample: Simulating Two Rolls of a Fair Four-Sided Die\n:::\n\n::: ex-cont\nWe're going to roll two four-sided die. Let $X$ be the sum of two rolls, and $Y$ be the larger of the two rolls. How would we simulate $X$ and $Y$ separately?\n:::\n:::::\n\n \n\n- Note: this example is not asking for a probability! \n    - We can simulate a random variable and looks at its distribution without calculating any probabilities.\n\n\n \n\n- We will focus on simulating $X$ first\n\n \n\nLet's build up some coding tools to do this!\n\n## How do we simulate something like a **single** dice roll?\n\n-   We can also use `R` to sample from the box or spinner\n\n-   The `sample()` function is a powerful tool for simulating draws from a box model.\n\n-   For example, we can simulate a coin flip\n\n      - What is `x`? \n      - What is `size`?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsample(x = c(\"H\", \"T\"), size = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"T\"\n```\n\n\n:::\n:::\n\n\n\n \n\n- Or a dice roll\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsample(x = c(1, 2, 3, 4), size = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1\n```\n\n\n:::\n:::\n\n\n\n## What if we have multiple rolls at once?\n\n- We can set `size` to be larger than 1 to simulate multiple draws at once\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsample(x = c(\"H\", \"T\"), size = 5, replace = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"T\" \"T\" \"T\" \"H\" \"T\"\n```\n\n\n:::\n:::\n\n\n\n-   We can simulate our example of the two four-sided dice\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsample(x = c(1, 2, 3, 4), size = 2, replace = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3 3\n```\n\n\n:::\n:::\n\n\n\n \n\n- What happens if we set `replace = FALSE`?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsample(x = c(1, 2, 3, 4), size = 2, replace = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4 2\n```\n\n\n:::\n\n```{.r .cell-code}\nsample(x = c(1, 2, 3, 4), size = 4, replace = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2 1 3 4\n```\n\n\n:::\n:::\n\n\n\n## Can we start to simulate many rolls of two dice?\n\n::::: example\n::: ex-title\nExample: Simulating Two Rolls of a Fair Four-Sided Die\n:::\n\n::: ex-cont\nWe're going to roll two four-sided dice. Let $X$ be the sum of two rolls, and $Y$ be the larger of the two rolls. How would we simulate $X$ and $Y$ separately?\n:::\n:::::\n\n- We've seen how to simulate a single pair of rolls\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrolls <- sample(x = c(1, 2, 3, 4), size = 2, replace = TRUE)\n```\n:::\n\n\n\n- We can use the `replicate()` function to repeat this process many times (we'll do 10)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreps <- 10\nreplicate(reps, sample(x = 1:4, size = 2, replace = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n[1,]    2    3    3    3    3    3    3    1    3     3\n[2,]    1    1    2    2    2    1    4    1    4     2\n```\n\n\n:::\n:::\n\n\n\n## We need more reps for long-run relative frequencies\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreps <- 10000\nsimulations <- replicate(reps, sample(x = 1:4, size = 2, replace = TRUE))\n```\n:::\n\n\n\n- Let's show the first 14 simulations\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimulations[, 1:14]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]\n[1,]    4    1    2    2    4    2    1    2    4     1     4     2     2     3\n[2,]    4    4    1    3    1    1    2    3    2     4     1     2     2     2\n```\n\n\n:::\n:::\n\n\n\n \n\n- $X$ is the sum of the two rolls: we could calculate that for each column\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX_simulated <- apply(simulations, 2, sum)\nX_simulated[1:14]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 8 5 3 5 5 3 3 5 6 5 5 4 4 5\n```\n\n\n:::\n:::\n\n\n\n## We can look at the plot of random variable $X$\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03_Simulations_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n\n\n## If we want to calculate something else, we can!\n\n::: columns\n::: {.column width=\"50%\"}\n\n- Average:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(X_simulated)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5.0044\n```\n\n\n:::\n:::\n\n\n\n- Standard deviation:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(X_simulated)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.574303\n```\n\n\n:::\n:::\n\n\n\n\n- Probability that $X=5$:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(X_simulated == 5) / reps\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2468\n```\n\n\n:::\n:::\n\n\n\n- Probability that $X<3$:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(X_simulated < 3) / reps\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0584\n```\n\n\n:::\n:::\n\n\n\n:::\n::: {.column width=\"50%\"}\n\n \n\n \n\n \n\n\n \n\n \n\n \n\n \n\n::: proof1\n::: proof-cont\nProbabilities (relative frequencies) are calculated by:\n\n- summing the number of times an event occurs and \n- dividing by the total number of simulations (reps)\n:::\n:::\n:::\n:::\n\n# Learning objectives\n\n1. Describe random variables and distinguish between discrete and continuous types\n2. Explain the role of simulation in approximating probabilities and distributions\n3. Use R to run simulations of discrete random variables\n\n::: lob\n4. Apply and interpret the four-step simulation process\n:::\n\n## 4 (S)teps of a Simulation\n\n::::: proposition\n::: prop-title\n1.  Set up\n:::\n\n::: prop-cont\nDefine the probability space and related random variables and events, including assumptions.\n:::\n:::::\n\n::::: proof1\n::: proof-title\n2.  Simulate\n:::\n\n::: proof-cont\nRun the simulation to generate outcomes according to the assumptions.\n:::\n:::::\n\n::::: example\n::: ex-title\n3.  Summarize\n:::\n\n::: ex-cont\nAnalyze the output using plots and summary statistics like relative frequencies and averages.\n:::\n:::::\n\n::::: extra\n::: ext-title\n4.  Sensitivity analysis\n:::\n\n::: ext-cont\nInvestigate how results change when assumptions or parameters of the model are altered.\n:::\n:::::\n\n## Example: Dice Rolls\n\n::::: example\n::: ex-title\nExample: Simulating Two Rolls of a Fair Four-Sided Die\n:::\n\n::: ex-cont\nWe're going to roll two four-sided die. Let $X$ be the sum of two rolls, and $Y$ be the larger of the two rolls. How would we simulate $X$ and $Y$ separately?\n:::\n:::::\n\n- Use the steps to run simulation for for $Y$ now\n\n## \n\n::::: proposition\n::: prop-title\n1.  Set up\n:::\n\n::: prop-cont\nDefine the probability space and related random variables and events, including assumptions.\n:::\n:::::\n\n- **Random variable:** $Y(\\omega)$ is the larger of the two rolls in outcome $\\omega$\n- **Goal:** simulate $Y$, the larger of two rolls of a fair four-sided die\n- **Sample space:** all possible outcomes of rolling two four-sided die\n    - Not necessary, but helpful to define the sample space\n    \n$$\\begin{aligned} S =  \\{ &(1,1), (1,2), (1,3), (1,4), (2,1), (2,2), (2,3), (2,4),\\\\ & (3,1), (3,2), (3,3), (3,4), (4,1), (4,2), (4,3), (4,4)\\} \\end{aligned}$$\n\n- **Assumptions:** each die is fair and rolls are independent\n  - Each outcome in $S$ is equally likely with probability $1/16$\n\n## \n\n::::: proof1\n::: proof-title\n2.  Simulate\n:::\n\n::: proof-cont\nRun the simulation to generate outcomes according to the assumptions.\n:::\n:::::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreps <- 10000\nsimulations <- replicate(reps, sample(x = 1:4, size = 2, replace = TRUE))\nY_simulated <- apply(simulations, 2, max)\n```\n:::\n\n\n\n \n\n- We can look at the first 30 simulations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY_simulated[1:30]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 3 4 4 4 2 4 4 4 2 3 4 4 1 4 4 3 4 4 2 4 4 4 1 4 2 2 4 4 3 3\n```\n\n\n:::\n:::\n\n\n\n## \n\n::::: example\n::: ex-title\n3.  Summarize\n:::\n\n::: ex-cont\nAnalyze the output using plots and summary statistics like relative frequencies and averages.\n:::\n:::::\n\n::: columns\n::: {.column width=\"55%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show/Hide Code for plotting Y\"}\nY_df <- as.data.frame(Y_simulated) %>%\n  rename(Y = Y_simulated)\n\nggplot(Y_df, aes(x = Y)) +\n  geom_histogram(binwidth = 1, color = \"black\", fill = \"#B3C8BF\") +\n  scale_x_continuous(breaks = seq(1, 4, by = 1)) +\n  labs(title = \"Simulated Distribution of Y (Larger of Two Rolls)\",\n       x = \"Value of Y\",\n       y = \"Frequency\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(size = 20), \n    axis.text.y = element_text(size = 20),\n    axis.title.x = element_text(size = 20),\n    axis.title.y = element_text(size = 20), \n    plot.title = element_text(size = 20)\n    )\n```\n\n::: {.cell-output-display}\n![](03_Simulations_files/figure-revealjs/unnamed-chunk-20-1.png){width=1056}\n:::\n:::\n\n\n\n:::\n::: {.column width=\"45%\"}\n\nIf the problem asked us for something else, we could compute it:\n\n- Average:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(Y_simulated)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.1199\n```\n\n\n:::\n:::\n\n\n\n- Probability that $Y=1$:  \n    \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(Y_simulated == 1) / reps\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0634\n```\n\n\n:::\n:::\n\n\n\n- Probability that $Y>3$:  \n    \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(Y_simulated > 3) / reps\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4356\n```\n\n\n:::\n:::\n\n\n\n:::\n:::\n\n## \n\n::::: extra\n::: ext-title\n4.  Sensitivity analysis\n:::\n\n::: ext-cont\nInvestigate how results change when assumptions or parameters of the model are altered.\n:::\n:::::\n\nWhat if we rolled three die instead of two?\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreps <- 10000\ndie <- 3\nsimulations <- replicate(\n  reps, \n  sample(x = 1:4, \n         size = die, \n         replace = TRUE)\n)\nsimulations[, 1:6]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2] [,3] [,4] [,5] [,6]\n[1,]    1    3    1    4    2    3\n[2,]    4    1    2    1    2    3\n[3,]    4    4    4    4    3    3\n```\n\n\n:::\n\n```{.r .cell-code}\nY_simulated <- apply(simulations, 2, max)\n```\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show/Hide Code for plotting Y\"}\nY_df <- as.data.frame(Y_simulated) %>%\n  rename(Y = Y_simulated)\n\nggplot(Y_df, aes(x = Y)) +\n  geom_histogram(binwidth = 1, color = \"black\", fill = \"#B3C8BF\") +\n  scale_x_continuous(breaks = seq(1, 4, by = 1)) +\n  labs(title = \"Simulated Distribution of Y (Larger of Two Rolls)\",\n       x = \"Value of Y\",\n       y = \"Frequency\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(size = 20), \n    axis.text.y = element_text(size = 20),\n    axis.title.x = element_text(size = 20),\n    axis.title.y = element_text(size = 20), \n    plot.title = element_text(size = 20)\n    )\n```\n\n::: {.cell-output-display}\n![](03_Simulations_files/figure-revealjs/unnamed-chunk-25-1.png){width=1056}\n:::\n:::\n\n\n\n:::\n:::\n\n# Learning Objectives\n\n1. Describe random variables and distinguish between discrete and continuous types\n2. Explain the role of simulation in approximating probabilities and distributions\n3. Use R to run simulations of discrete random variables\n4. Apply and interpret the four-step simulation process\n",
    "supporting": [
      "03_Simulations_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}