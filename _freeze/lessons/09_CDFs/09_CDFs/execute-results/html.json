{
  "hash": "a6b942d6f6081d1130a2de46dc2e22d1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lesson 9: Cumulative distribution functions (CDFs)\"\nauthor: \"Nicky Wakim\"\ndate: \" 2025-10-22 \"\ntitle-slide-attributes:\n    data-background-color: \"#006a4e\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Lesson 9 Slides\n    html-math-method: mathjax\n---\n\n# Learning Objectives\n\n1. Understand the definition of cumulative distribution functions (CDFs) for discrete and continuous random variables.\n2. Compute CDFs for given probability mass functions (pmfs). \n3. Compute CDFs for given probability density functions (pdfs) and pdfs from CDFs.\n\n## Where are we?\n\n![](../img_slides/course_map.png){fig-align=\"center\"}\n\n\n\n# Learning Objectives\n\n::: lob\n1. Understand the definition of cumulative distribution functions (CDFs) for discrete and continuous random variables.\n:::\n\n2. Compute CDFs for given probability mass functions (pmfs). \n3. Compute CDFs for given probability density functions (pdfs) and pdfs from CDFs.\n\n## What is a cumulative distribution function?\n\n::: columns\n\n::: {.column width=\"50%\"}\n\n::: definition\n::: def-title\nCumulative distribution function (CDF) for discrete random variable\n:::\n\n::: def-cont\nThe **cumulative distribution function** (**cdf**) of a **discrete RV** $X$ with pmf $p_X(x)$, is defined for every value $x$ by $$F_X(x) = \\mathbb{P}(X \\leq x) = \\sum \\limits_{\\{all\\ y:\\ y\\leq x\\}}p_X(y)$$\n:::\n:::\n\n-   $F(x)$ is increasing or flat (never decreasing)\n\n-   $\\min\\limits_x F(x) = 0$\n\n-   $\\max\\limits_xF(x)=1$\n\n-   CDF is a step function\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: definition\n::: def-title\nCumulative distribution function (CDF) for continuous random variable\n:::\n\n::: def-cont\nThe **cumulative distribution function (cdf)** of a **continuous RV** $X$, is the function $F_X(x)$, such that for all real values of\n$x$, $$F_X(x)= \\mathbb{P}(X \\leq x) = \\int_{-\\infty}^x f_X(s)ds$$\n:::\n:::\n\n**Remarks:** In general, $F_X(x)$ is increasing and\n\n-   $\\lim_{x\\rightarrow -\\infty} F_X(x)= 0$\n\n-   $\\lim_{x\\rightarrow \\infty} F_X(x)= 1$\n\n-   $P(X > a) = 1 - P(X \\leq a) = 1 - F_X(a)$\n\n-   $P(a \\leq X \\leq b) = F_X(b) - F_X(a)$\n\n:::\n\n:::\n\n## How to define CDFs for discrete and continuous RVs?\n\n::: columns\n::: column\nDiscrete RV $X$:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](09_CDFs_files/figure-revealjs/unnamed-chunk-1-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n- pmf: $p_X(x) = P(X=x)$\n- CDF: $F_X(x) = P(X \\leq x) = \\sum\\limits_{\\{all\\ y:\\ y\\leq x\\}} p_X(y)$\n:::\n::: column\nContinuous RV $X$:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](09_CDFs_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n- density: $f_X(x)$\n- probability: $P(a \\leq X \\leq b) = \\int_a^b f_X(x)dx$\n- CDF: $F_X(x) = P(X \\leq x) = \\int_{-\\infty}^x f_X(s)ds$\n:::\n:::\n\n# Learning Objective\n\n1. Understand the definition of cumulative distribution functions (CDFs) for discrete and continuous random variables.\n\n::: lob\n2. Compute CDFs for given probability mass functions (pmfs). \n:::\n\n3. Compute CDFs for given probability density functions (pdfs) and pdfs from CDFs.\n\n## Falls in Older Adults Revisited (1/5)\n\n::: columns\n::: {.column width=\"100%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\nA major public health concern is falls among older adults (age 65+). National data suggests that 25% of older adults will experience at least one fall within a given year. A community health program is tracking a random group of $n = 8$ older adults for one year. Assume the likelihood of falling is independent from person to person.\n\nLet $X$ be the random variable representing the number of individuals in this group who experience at least one fall.\n\n1. Write the CDF of $X$ and make a table of values.\n2. Use R to calculate the cumulative probability for each possible value of $X$.\n3. Plot the CDF of $X$.\n4. Simulate $X$ for 10000 groups and plot the approximated CDF.\n:::\n:::\n:::\n:::\n\nRecall our pmf: $$P(X = x) = \\binom{8}{x} 0.25^x 0.75^{8-x},  x= 0, 1, 2, \\dots, 8 $$\n\n## Falls in Older Adults Revisited (2/5)\n\n::: columns\n::: {.column width=\"100%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n1. Write the CDF of $X$.\n:::\n:::\n:::\n:::\n\nRecall our pmf: $$P(X = x) = \\binom{8}{x} 0.25^x 0.75^{8-x},  x= 0, 1, 2, \\dots, 8 $$\n\n\n$$F_X(x) = P(X \\leq x) = \\sum \\limits_{k=0}^{x} \\binom{8}{k} 0.25^y 0.75^{8-k}$$\n\n## Falls in Older Adults Revisited (3/5)\n\n::: columns\n::: {.column width=\"50%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n2. Use R to calculate the cumulative probability for each possible value of $X$.\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 8\np = 0.25\n\nfalls_cdf <- tibble(\n  x = 0:n,\n  c_prob = pbinom(x, size = n, prob = p)\n)\n```\n:::\n\n\n:::\n\n::: column\n\n \n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfalls_cdf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 2\n      x c_prob\n  <int>  <dbl>\n1     0  0.100\n2     1  0.367\n3     2  0.679\n4     3  0.886\n5     4  0.973\n6     5  0.996\n7     6  1.00 \n8     7  1.00 \n9     8  1    \n```\n\n\n:::\n:::\n\n\n:::\n:::\n\n## Falls in Older Adults Revisited (4/5)\n\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n3. Plot the CDF of $X$.\n:::\n:::\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code}\nggplot(\n  falls_cdf,\n  aes(x = x, y = c_prob)\n       ) +\n  geom_step(\n    size = 1, \n    color = \"black\"\n    ) +\n  labs(\n    x = \"Number of Falls\",\n    y = \"Cumulative Probability\",\n    title = \"CDF of X\"\n    )\n```\n\n::: {.cell-output-display}\n![](09_CDFs_files/figure-revealjs/unnamed-chunk-5-1.png){width=864}\n:::\n:::\n\n\n## Falls in Older Adults Revisited (4/5)\n\n::: columns\n::: {.column width=\"50%\"}\n::: example\n::: ex-title\nExample 1: Falls in Older Adults\n:::\n\n::: ex-cont\n4. Simulate $X$ for 10000 groups and plot the approximated CDF.\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4764)\nreps = 10000\n\nsims = rbinom(n = reps, \n              size = n, \n              prob = p)\n\nsims %>% head(., 14)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 2 1 2 1 3 3 2 2 4 2 3 0 2 0\n```\n\n\n:::\n\n```{.r .cell-code}\nfalls2 <- tibble(x = 0:n) %>%\n  rowwise() %>%\n  mutate(c_prob = sum(sims <= x) / reps)\n```\n:::\n\n\n:::\n\n::: column\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(falls2, aes(x = x, y = c_prob)) +\n  geom_step(size = 1, color = \"black\") +\n  labs(\n    title = \"Approximate CDF of X\",\n    x = \"Number of adults (x)\",\n    y = \"Approximate Cumulative Probability\"\n  ) \n```\n\n::: {.cell-output-display}\n![](09_CDFs_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=864}\n:::\n:::\n\n:::\n\n:::\n\n# Learning Objective\n\n1. Understand the definition of cumulative distribution functions (CDFs) for discrete and continuous random variables.\n2. Compute CDFs for given probability mass functions (pmfs). \n\n::: lob\n3. Compute CDFs for given probability density functions (pdfs) and pdfs from CDFs.\n:::\n\n## Let's demonstrate the CDF with an example\n\n::: columns\n::: {.column width=\"30%\"}\n::: example\n::: ex-title\nExample 2\n:::\n\n::: ex-cont\nLet $f_X(x)= 2$, for $2.5 \\leq x \\leq 3$. Find $F_X(x)$.\n:::\n:::\n:::\n:::\n\n## Derivatives of the CDF\n\n::: theorem\n::: thm-title\nTheorem 1\n:::\n\n::: thm-cont\nIf $X$ is a continuous random variable with pdf $f_X(x)$ and cdf\n$F_X(x)$, then for all real values of $x$ at which $F'_X(x)$ exists,\n$$\\frac{d}{dx} F_X(x)= F'_X(x) = f_X(x)$$\n:::\n:::\n\n## Finding the PDF from a CDF\n\n::: columns\n::: {.column width=\"38%\"}\n::: example\n::: ex-title\nExample 3\n:::\n\n::: ex-cont\nLet $X$ be a RV with cdf $$F_X(x)= \\left\\{\n        \\begin{array}{ll}\n            0 & \\quad x < 2.5 \\\\\n            2x-5 & \\quad 2.5 \\leq x \\leq 3 \\\\\n            1 & \\quad x > 3\n        \\end{array}\n    \\right.$$ Find the pdf $f_X(x)$.\n:::\n:::\n:::\n:::\n\n## Let's go through another example (1/7)\n\n::: columns\n::: {.column width=\"100%\"}\n::: example\n::: ex-title\nExample 4\n:::\n\n::: ex-cont\nLet $X$ be a RV with pdf $f_X(x)= 2e^{-2x}$, for $x>0$.\n\n1.  Show $f_X(x)$ is a pdf.\n\n2.  Find $\\mathbb{P}(1 \\leq X \\leq 3)$.\n\n3.  Find $F_X(x)$.\n\n4.  Given $F_X(x)$, find $f_X(x)$.\n\n5.  Find $\\mathbb{P}(X \\geq 1 | X \\leq 3)$.\n\n6.  Find the median of the distribution of $X$.\n:::\n:::\n:::\n:::\n\n## Let's go through another example (2/7)\n\n::: columns\n::: {.column width=\"30%\"}\n::: example\n::: ex-title\nExample 4.1\n:::\n\n::: ex-cont\nLet $X$ be a RV with pdf $f_X(x)= 2e^{-2x}$, for $x>0$.\n\n1.  Show $f_X(x)$ is a pdf.\n:::\n:::\n:::\n:::\n\n## Let's go through another example (3/7)\n\n::: {.callout-important appearance=\"simple\" icon=\"false\"}\nDo this problem at home for extra practice.\n:::\n\n::: columns\n::: {.column width=\"30%\"}\n::: example\n::: ex-title\nExample 4.2\n:::\n\n::: ex-cont\nLet $X$ be a RV with pdf $f_X(x)= 2e^{-2x}$, for $x>0$.\n\n2.  Find $\\mathbb{P}(1 \\leq X \\leq 3)$.\n:::\n:::\n:::\n:::\n\n## Let's go through another example (4/7)\n\n::: columns\n::: {.column width=\"30%\"}\n::: example\n::: ex-title\nExample 4.3\n:::\n\n::: ex-cont\nLet $X$ be a RV with pdf $f_X(x)= 2e^{-2x}$, for $x>0$.\n\n3.  Find $F_X(x)$.\n:::\n:::\n:::\n:::\n\n## Let's go through another example (5/7)\n\n::: {.callout-important appearance=\"simple\" icon=\"false\"}\nDo this problem at home for extra practice.\n:::\n\n::: columns\n::: {.column width=\"30%\"}\n::: example\n::: ex-title\nExample 4.4\n:::\n\n::: ex-cont\nLet $X$ be a RV with pdf $f_X(x)= 2e^{-2x}$, for $x>0$.\n\n4.  Given $F_X(x)$, find $f_X(x)$.\n:::\n:::\n:::\n:::\n\n## Let's go through another example (6/7)\n\n::: columns\n::: {.column width=\"30%\"}\n::: example\n::: ex-title\nExample 4.5\n:::\n\n::: ex-cont\nLet $X$ be a RV with pdf $f_X(x)= 2e^{-2x}$, for $x>0$.\n\n5.  Find $\\mathbb{P}(X \\geq 1 | X \\leq 3)$.\n:::\n:::\n:::\n:::\n\n## Let's go through another example (7/7)\n\n::: columns\n::: {.column width=\"30%\"}\n::: example\n::: ex-title\nExample 4.6\n:::\n\n::: ex-cont\nLet $X$ be a RV with pdf $f_X(x)= 2e^{-2x}$, for $x>0$.\n\n6.  Find the median of the distribution of $X$.\n:::\n:::\n:::\n:::\n",
    "supporting": [
      "09_CDFs_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}